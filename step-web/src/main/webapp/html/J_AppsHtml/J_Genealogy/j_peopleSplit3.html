<!DOCTYPE html>
  <!-- ================================================================================
       Multi-frame layout: This caters for a layout where multiple frames appear
       together on a wide screen, but appear on separate tabs on a smaller screen.

       To save making this page into an unncessarily large download, I have added
       detailed comments into j_framwork.multiframeController.js.  There are still
       some important comments below, however.  And in the HTML, I have added notes
       which cross-refer to j_framework.multiframeController.js.

       Much of this you should retain as-is, or modify only in a very limited manner.
       However, this isn't just a template: it's a working web page, and therefore
       contains things specific to the genealogy application for which it was
       originally designed.  These I have highlighted below with '*** CHANGE ME ***'
       to highlight bits you will need to change for your application.
       ================================================================================ -->
       
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link href="/css/J_AppsCss/J_Framework/j_framework.common.css" rel="stylesheet" media="screen"/>
  <link href="/css/J_AppsCss/J_Framework/j_framework.multiframeLayoutController.css" rel="stylesheet" media="screen"/>
  <link rel="stylesheet" href="https://early.webawesome.com/webawesome@3.0.0-beta.5/dist/styles/webawesome.css"/>
  <script type="module" src="https://early.webawesome.com/webawesome@3.0.0-beta.5/dist/webawesome.loader.js"></script>
  <script src="/libs/jquery-1.10.2.min.js" type="text/javascript"></script>
  <style>
    jframework-wideLayoutContentContainer {
      display: flex;
      height: 100%;
    }

    wa-split-panel.genealogy-split-panel {
      width: 100%;
      height: 100%;
      --divider-width: 4px;
    }

    wa-split-panel.genealogy-split-panel::part(divider) {
      background-color: var(--clrHighlight, #d16f6d);
      cursor: col-resize;
    }

    wa-split-panel.genealogy-split-panel > jframework-leftColumn,
    wa-split-panel.genealogy-split-panel > jframework-rightColumn {
      display: flex;
      flex-direction: column;
      min-width: 0;
      width: auto !important;
      height: 100%;
    }
  </style>
</head>


<body>
  <!-- ========== *** CHANGE ME *** You need to create a jframework-frameList as below and configure it.  See j_framework.multiframeLayoutController.js Note 1.

       MAKE SURE you put the jframework-tabLegend tag immediately after the </iframe>: don't have a newline or space between them.
    -->
  <jframework-iframeList>
    <iframe id='genealogy'   wantSrc='html/J_AppsHtml/J_Genealogy/j_genealogy.html'   scrolling='no' ></iframe><jframework-tabLegend>Genealogy</jframework-tabLegend>
    <iframe id='scripture'   suppressStepHeader='yes'                                 scrolling='yes'></iframe><jframework-tabLegend>Scripture</jframework-tabLegend>
    <iframe id='peopleIndex' wantSrc='html/J_AppsHtml/J_Genealogy/j_peopleIndex.html' scrolling='yes'></iframe><jframework-tabLegend>Search</jframework-tabLegend>
  </jframework-iframeList>





  <!-- ========== *** CHANGE ME *** You need to configure the content of #jframework-wideLayoutContentContainer.  See j_framework.multiframeLayoutController.js Note 2. ========== -->
  <jframework-wideLayoutVisibilityController class='jframework-invisible-offscreen'>
    <jframework-wideLayoutContentContainer>

      
      <wa-split-panel class='genealogy-split-panel' orientation="horizontal" position="50">
	<jframework-leftColumn slot="start">
	  <jframework-iframePlaceHolder iframeId='peopleIndex'></jframework-iframePlaceHolder>
	  <!-- <div class='jframework-heightResizer jframework-horizontalSeparator'></div> --><!-- Optional: This gives you space between the rows, and a line which you can drag to resize things. -->
	  <div class='jframework-horizontalSeparator'></div>
	  <jframework-iframePlaceHolder iframeId='scripture'></jframework-iframePlaceHolder>
	</jframework-leftColumn>

	<jframework-rightColumn slot="end">
	  <jframework-iframePlaceHolder iframeId='genealogy'></jframework-iframePlaceHolder>
	</jframework-rightColumn>
      </wa-split-panel>


    </jframework-wideLayoutContentContainer>
  </jframework-wideLayoutVisibilityController>



  
  <!-- ========== Don't alter this section.  See j_framework.multiframeLayoutController.js Note 3. ========== -->
  <jframework-tabbedLayoutVisibilityController class='jframework-invisible-offscreen'>
      <jframework-tabbedLayoutButtonBar>
	<!-- Buttons will be generated here. -->
      </jframework-tabbedLayoutButtonBar>

      <jframework-tabbedLayoutContent>
	<!-- iframes and associated content will be generated here. -->
      </jframework-tabbedLayoutContent>
  </div>





  <script type='module'>
    /**************************************************************************/
    /* Note 4 */
    /**************************************************************************/

    /**************************************************************************/
    import                                               '/js/J_AppsJs/J_Genealogy/j_peopleSplit3.js';
    import { JFrameworkUtils }                      from '/js/J_AppsJs/J_Framework/j_framework.utils.js';
    import { JFrameworkMultiframeLayoutController } from '/js/J_AppsJs/J_Framework/j_framework.multiframeLayoutController.js';


    /**************************************************************************/
    /* The present page may be invoked with a URL containing a 'strong'
       attribute, in which case we want to organise to bring things up showing
       details for the relevant person. */
    
    let splitPanelSetupScheduled = false;

    async function setupSplitPanel ()
    {
	const splitPanel = document.querySelector('wa-split-panel.genealogy-split-panel');
	if (!splitPanel || !window.customElements)
	    return;

	await customElements.whenDefined('wa-split-panel');

	const leftColumn  = splitPanel.querySelector('jframework-leftColumn[slot=\"start\"]');
	const rightColumn = splitPanel.querySelector('jframework-rightColumn[slot=\"end\"]');

	if (!splitPanel.hasAttribute('position'))
	    splitPanel.setAttribute('position', '50');

	if (leftColumn)
	{
	    leftColumn.style.removeProperty('width');
	    leftColumn.style.removeProperty('flex');
	}

	if (rightColumn)
	    rightColumn.style.removeProperty('width');

	const panelBox = splitPanel.getBoundingClientRect();
	const leftBox = leftColumn ? leftColumn.getBoundingClientRect() : null;

	if (panelBox && panelBox.width > 0 && leftBox && leftBox.width >= 0)
	{
	    const position = Math.max(0, Math.min(100, (leftBox.width / panelBox.width) * 100));
	    if (!Number.isNaN(position))
	    {
		const current = parseFloat(splitPanel.getAttribute('position'));
		if (Number.isNaN(current) || Math.abs(current - position) > 0.1)
		{
		    splitPanel.position = position;
		    splitPanel.setAttribute('position', position.toFixed(2));
		}
	    }
	}
    }

    function scheduleSplitPanelSetup ()
    {
	if (splitPanelSetupScheduled)
	    return;

	splitPanelSetupScheduled = true;
	requestAnimationFrame(() =>
	{
	    splitPanelSetupScheduled = false;
	    setupSplitPanel();
	});
    }

    function onload ()
    {
	window.dataStoreForIframes = new Map();
	
	const strong = new URLSearchParams(new URL(window.location.href).search).get("strong");
	if (strong)
	{
	    const peopleIndex = document.getElementById('peopleIndex');
	    peopleIndex.setAttribute('wantSrc', peopleIndex.getAttribute('wantSrc') + '?strong=' + strong);
	}
	JFrameworkMultiframeLayoutController.onload();
	scheduleSplitPanelSetup();
    }

    function handleResize ()
    {
	JFrameworkMultiframeLayoutController.resize();
	scheduleSplitPanelSetup();
    }

    JFrameworkUtils.setOnloadEtc(onload, handleResize);
  </script>
</body>
</html>
